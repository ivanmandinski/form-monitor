# Railway Environment Variables Reference

This document lists all environment variables you need to configure for Railway deployment.

## üî¥ Required Variables (Must Set)

These are essential for the application to run:

```env
# Application Core
APP_NAME="Form Monitor"
APP_ENV=production
APP_KEY=                         # Generate with: php artisan key:generate --force
APP_DEBUG=false
APP_URL=https://your-app.up.railway.app  # Update after getting Railway domain

# Database (Use Railway's variable references)
DB_CONNECTION=pgsql              # or 'mysql'
DB_HOST=${{Postgres.DB_HOST}}    # or ${{MySQL.DB_HOST}}
DB_PORT=${{Postgres.DB_PORT}}    # or ${{MySQL.DB_PORT}}
DB_DATABASE=${{Postgres.DB_DATABASE}}  # or ${{MySQL.DB_DATABASE}}
DB_USERNAME=${{Postgres.DB_USER}}      # or ${{MySQL.DB_USER}}
DB_PASSWORD=${{Postgres.DB_PASSWORD}}  # or ${{MySQL.DB_PASSWORD}}

# Redis (Use Railway's variable references)
REDIS_HOST=${{Redis.REDIS_HOST}}
REDIS_PASSWORD=${{Redis.REDIS_PASSWORD}}
REDIS_PORT=${{Redis.REDIS_PORT}}

# Drivers
CACHE_DRIVER=redis
SESSION_DRIVER=redis
QUEUE_CONNECTION=redis
BROADCAST_DRIVER=redis
```

## üü° Recommended Variables (Should Set)

These have defaults but should be configured for production:

```env
# Logging
LOG_CHANNEL=stack
LOG_LEVEL=error
LOG_DEPRECATIONS_CHANNEL=null

# Application Settings
APP_TIMEZONE=UTC
APP_LOCALE=en
APP_FALLBACK_LOCALE=en

# Session
SESSION_LIFETIME=120

# Telescope (Disable in production)
TELESCOPE_ENABLED=false
```

## üü¢ Form Monitor Specific (Optional but Recommended)

These customize form monitoring behavior:

```env
# User Agent
FORM_MONITOR_USER_AGENT="Form Monitor Bot/1.0"

# Timeouts (seconds)
FORM_MONITOR_HTTP_TIMEOUT=30
FORM_MONITOR_DUSK_TIMEOUT=60
FORM_MONITOR_PUPPETEER_TIMEOUT=120

# Concurrency
FORM_MONITOR_MAX_CONCURRENT_PER_HOST=2
FORM_MONITOR_GLOBAL_MAX_CONCURRENT=10

# Request Delays (seconds)
FORM_MONITOR_DELAY_BETWEEN_REQUESTS=1
FORM_MONITOR_DELAY_PER_HOST=2

# Artifacts
FORM_MONITOR_ARTIFACT_RETENTION_DAYS=30
FORM_MONITOR_MAX_HTML_SIZE=1048576        # 1MB in bytes
FORM_MONITOR_SCREENSHOT_QUALITY=80

# Logging
FORM_MONITOR_LOG_ALL_REQUESTS=true
FORM_MONITOR_LOG_ARTIFACTS=false
FORM_MONITOR_REDACT_PII=true

# Scheduling
FORM_MONITOR_CHECK_INTERVAL=60            # seconds
FORM_MONITOR_MAX_RUNTIME=300              # seconds
```

## üü¢ Puppeteer Configuration (Required for Puppeteer driver)

```env
PUPPETEER_HEADLESS=true
PUPPETEER_DEBUG=false
PUPPETEER_USER_DATA_DIR=                  # Optional, leave empty for Railway
```

## üü¢ CAPTCHA Solver (Optional)

Only needed if you want CAPTCHA solving functionality:

```env
CAPTCHA_SOLVER_API_KEY=                   # Your 2captcha API key
CAPTCHA_SOLVER_PROVIDER=2captcha          # 2captcha, anticaptcha, etc.
CAPTCHA_SOLVER_TIMEOUT=120                # seconds
CAPTCHA_SOLVER_RETRY_ATTEMPTS=3
CAPTCHA_SOLVE_SCORE_BASED=true
CAPTCHA_SOLVE_INACTIVE_CHALLENGES=true
CAPTCHA_SOLVE_RECAPTCHA_V3=true
CAPTCHA_SOLVE_RECAPTCHA_V2=true
CAPTCHA_SOLVE_HCAPTCHA=true
CAPTCHA_VISUAL_FEEDBACK=true
```

## üü¢ Mail Configuration (Optional)

Configure if you need email functionality:

```env
MAIL_MAILER=smtp
MAIL_HOST=smtp.mailtrap.io
MAIL_PORT=2525
MAIL_USERNAME=your_username
MAIL_PASSWORD=your_password
MAIL_ENCRYPTION=tls
MAIL_FROM_ADDRESS=noreply@yourdomain.com
MAIL_FROM_NAME="${APP_NAME}"
```

## üü¢ AWS S3 Storage (Optional)

Only needed if using S3 for artifact storage instead of local:

```env
FILESYSTEM_DISK=s3
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_DEFAULT_REGION=us-east-1
AWS_BUCKET=
AWS_USE_PATH_STYLE_ENDPOINT=false
```

## üü¢ Horizon Configuration (Optional)

Customize Horizon queue dashboard:

```env
HORIZON_DOMAIN=                           # Optional subdomain
HORIZON_PATH=horizon                      # Default: /horizon
```

## üîµ Variables Generated by Railway

These are automatically provided by Railway services (use `${{Service.VAR}}` syntax):

### From PostgreSQL Service:
- `${{Postgres.DB_HOST}}`
- `${{Postgres.DB_PORT}}`
- `${{Postgres.DB_DATABASE}}`
- `${{Postgres.DB_USER}}`
- `${{Postgres.DB_PASSWORD}}`
- `${{Postgres.DATABASE_URL}}`

### From MySQL Service:
- `${{MySQL.DB_HOST}}`
- `${{MySQL.DB_PORT}}`
- `${{MySQL.DB_DATABASE}}`
- `${{MySQL.DB_USER}}`
- `${{MySQL.DB_PASSWORD}}`
- `${{MySQL.DATABASE_URL}}`

### From Redis Service:
- `${{Redis.REDIS_HOST}}`
- `${{Redis.REDIS_PORT}}`
- `${{Redis.REDIS_PASSWORD}}`
- `${{Redis.REDIS_URL}}`

## üìù Quick Setup Checklist

1. ‚úÖ Set `APP_NAME`
2. ‚úÖ Set `APP_ENV=production`
3. ‚úÖ Set `APP_DEBUG=false`
4. ‚úÖ Generate `APP_KEY` (run `php artisan key:generate --force`)
5. ‚úÖ Set `APP_URL` (after Railway generates domain)
6. ‚úÖ Configure database variables (use `${{Postgres.*}}` or `${{MySQL.*}}`)
7. ‚úÖ Configure Redis variables (use `${{Redis.*}}`)
8. ‚úÖ Set drivers: `CACHE_DRIVER=redis`, `SESSION_DRIVER=redis`, `QUEUE_CONNECTION=redis`
9. ‚úÖ Set `TELESCOPE_ENABLED=false` (or secure it)
10. ‚úÖ Configure `FORM_MONITOR_*` variables as needed
11. ‚úÖ Configure `PUPPETEER_*` variables
12. ‚ö†Ô∏è Add `CAPTCHA_SOLVER_API_KEY` only if needed

## üîê Security Notes

- **Never commit** `.env` files or environment variables to Git
- `APP_KEY` should be generated, never hardcoded
- Database and Redis credentials are auto-generated by Railway
- `APP_DEBUG` must be `false` in production
- `TELESCOPE_ENABLED` should be `false` or properly secured

## üìã Complete Minimal Example

For a minimal working setup:

```env
APP_NAME="Form Monitor"
APP_ENV=production
APP_KEY=base64:xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx==
APP_DEBUG=false
APP_URL=https://your-app.up.railway.app

DB_CONNECTION=pgsql
DB_HOST=${{Postgres.DB_HOST}}
DB_PORT=${{Postgres.DB_PORT}}
DB_DATABASE=${{Postgres.DB_DATABASE}}
DB_USERNAME=${{Postgres.DB_USER}}
DB_PASSWORD=${{Postgres.DB_PASSWORD}}

REDIS_HOST=${{Redis.REDIS_HOST}}
REDIS_PASSWORD=${{Redis.REDIS_PASSWORD}}
REDIS_PORT=${{Redis.REDIS_PORT}}

CACHE_DRIVER=redis
SESSION_DRIVER=redis
QUEUE_CONNECTION=redis

TELESCOPE_ENABLED=false

PUPPETEER_HEADLESS=true
PUPPETEER_DEBUG=false
```

## üöÄ Generating APP_KEY

After setting up variables in Railway, generate the APP_KEY:

```bash
# Via Railway CLI
railway run php artisan key:generate --force

# Or via Railway dashboard terminal
php artisan key:generate --force
```

This will automatically update the `APP_KEY` in your Railway environment variables.

